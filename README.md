# Pairwise Seqence Alignment Benchmark



## Introduction

The purpose of this benchmark is to assess various pairwise sequence alignment libraries. Unlike previous benchmarks, which only tested runtime and peak memory usage without assessing accuracy, this benchmark aims to test accuracy in addition to runtime and peak memory usage. The main steps of this benchmark are as follows:

* Use PBSIM to simulate reads with fixed lengths and error rates, thereby generating pairwise sequence data for alignment.
* Run different alignment libraries to generate pairwise sequence alignment results, including alignment scores and CIGAR strings.
* Collect the alignment information from the answer files generated by PBSIM, including alignment scores and CIGAR strings.
* Compare the results obtained in step 2 with the answer information from step 3 to evaluate accuracy metrics.



## Features

* **Comprehensive Algorithm Support**: Supports most of the mainstream sequence alignment libraries currently available, including Edlib,ksw2,WFA2.
* **Multi-metric Evaluation**: Measures performance across runtime, accuracy, and resource usage.
* **Extensibility**: Modular design allows for easy addition of new algorithms or custom evaluation metrics.
* **Automated Experimentation**: Quickly configure and execute large-scale experiments using provided scripts.



## Evaluation Metrics

- **Runtime**: Time taken by each algorithm to process the same dataset.
- **Memory Usage**: Memory consumed during algorithm execution.
- **Alignment Accuracy**: Consistency of alignment scores compared to ground truth.



## Supported Libraries

| **Library**  | Year | **Intra-seq** | **CIGAR** | **Gap-affine** | **Local** | **Global** | **Glocal** | **Extension** |
| :----------- | ---- | :-----------: | :-------: | :------------: | :-------: | :--------: | :--------: | :-----------: |
| **Libssa**   | 2011 |      No       |    No     |      Yes       |   Fast    |    Fast    |    N/A     |      N/A      |
| **Opal**     | 2013 |      No       |    No     |      Yes       |   Fast    |    Fast    |    Fast    |      N/A      |
| **SWIPE**    | 2011 |      No       |    Yes    |      Yes       |   Fast    |    N/A     |    N/A     |      N/A      |
| **BitPAl**   | 2014 |      Yes      |    No     |       No       |    N/A    |    Fast    |    N/A     |      N/A      |
| **Edlib**    | 2017 |      Yes      |    Yes    |       No       |   Fast    |    Fast    |    Fast    |      N/A      |
| **SeqAn**    | 2008 |      Yes      |    Yes    |      Yes       |   Slow    |    Slow    |    Slow    |      N/A      |
| **SWPS3**    | 2008 |      Yes      |    No     |      Yes       |   Fast    |    N/A     |    N/A     |      N/A      |
| **SSW**      | 2013 |      Yes      |    Yes    |      Yes       |   Fast    |    N/A     |    N/A     |      N/A      |
| **Parasail** | 2016 |      Yes      |    No     |      Yes       |   Fast    |    Fast    |    Fast    |      N/A      |
| **Libgaba**  | 2018 |      Yes      |    Yes    |      Yes       |    N/A    |    N/A     |    N/A     |     Fast      |
| **KSW2**     | 2018 |      Yes      |    Yes    |      Yes       |    N/A    |    Fast    |    N/A     |     Fast      |
| **WFA**      | 2021 |      Yes      |    Yes    |      Yes       |   Fast    |    Fast    |    Fast    |     Fast      |
| **wfalm**    | 2022 |      Yes      |    Yes    |      Yes       |   Fast    |    Fast    |    Fast    |     Fast      |
| **BiWFA**    | 2023 |      Yes      |    Yes    |      Yes       |   Fast    |    Fast    |    Fast    |     Fast      |



## Performance Analysis

| Dataset(Length,Error Rate,Num) | Time(s) | Peak Memory(MB) | Accuracy(recall) | CIGAR | Detailed Mode  | Source   |
| ------------------------------ | ------- | --------------- | ---------------- | :---: | -------------- | -------- |
| 100k,0.05,30                   | 12.7    | 4               | 100%             |   Y   | Edlib          | Edlib    |
|                                | 67.9    | 1               | 100%             |   N   | BitPAl         | BitPAl   |
|                                | 1603.0  | 22              | 100%             |   N   | Parasail_scan  | Parasail |
|                                | 257.8   | 57322           | 100%             |   Y   | ksw2_extz2_sse | ksw2     |
|                                | 21.35   | 2777            | 100%             |   Y   | WFA-high       | WFA2     |
|                                | 18.5    | 11.6            | 100%             |   Y   | BiWFA          | WFA2     |
|                                | 81.5    | 2731            | 100%             |   Y   | wfalm-high     | wfalm    |
|                                | 417.1   | 29              | 100%             |   Y   | wfalm-rec      | wfalm    |
| 300k,0.05,10                   | 24.2    | 5               | 100%             |   Y   | Edlib          | Edlib    |
|                                | 204.6   | 2               | 100%             |   N   | BitPAl         | BitPAl   |
|                                | 5121.2  | 42              | 100%             |   N   | Parasail_scan  | Parasail |
|                                | 834.7   | 265986          | 100%             |   Y   | ksw2_extz2_sse | ksw2     |
|                                | 70.3    | 24987           | 100%             |   Y   | WFA-high       | WFA2     |
|                                | 61.0    | 198             | 100%             |   Y   | BiWFA          | WFA2     |
|                                | 243.1   | 24306           | 100%             |   Y   | wfalm-high     | wfalm    |
|                                | 1421.9  | 82              | 100%             |   Y   | wfalm-rec      | wfalm    |
| 300k,0.1,10                    | 44.4    | 5               | 100%             |   Y   | Edlib          | Edlib    |
|                                | 207.0   | 2               | 100%             |   N   | BitPAl         | BitPAl   |
|                                | 5095.8  | 42              | 100%             |   N   | Parasail_scan  | Parasail |
|                                | 838.8   | 293452          | 100%             |   Y   | ksw2_extz2_sse | ksw2     |
|                                | 240.6   | 85200           | 100%             |   Y   | WFA-high       | WFA2     |
|                                | 198.5   | 40              | 100%             |   Y   | BiWFA          | WFA2     |
|                                | 839.0   | 81896           | 100%             |   Y   | wfalm-high     | wfalm    |
|                                | 4896.6  | 151             | 100%             |   Y   | wfalm-rec      | wfalm    |

Edlib demonstrated excellent performance in both speed and memory efficiency but is limited to computing edit distances only. Similarly, BitPAl supports only edit distances and linear gap penalties without affine gap scoring, but it excels in minimal memory usage, making it suitable for lightweight tasks.Parasail leverages SIMD to parallelize the classic Smith-Waterman algorithm, with its fastest variant, Parasail_scan, using suffix arrays for acceleration. Despite hardware-level optimizations, its quadratic time complexity limits performance on long sequences.

KSW2, a library from the Minimap2 tool, implements highly optimized algorithms based on Hajime Suzukiâ€™s diagonal formulation. It supports fixed banding and optionally produces CIGAR paths. By utilizing SSE2 and SSE4.1 intrinsics, KSW2 achieves significant performance improvements but comes with high memory consumption.WFA2 is currently the fastest and most efficient library for pairwise sequence alignment. Its ultralow memory mode (BIWFA) employs a bidirectional wavefront algorithm, significantly enhancing speed and memory efficiency. wfalm, an optimized version of WFA, incorporates recursive and memory-adaptive variations to achieve better time and space complexity, making it highly practical for large-scale tasks.

This comprehensive evaluation aims to assist researchers in selecting the most suitable sequence alignment libraries, accelerating alignment processes, and driving further advancements in the field.
